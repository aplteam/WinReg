 R←Test_004(stopFlag batchFlag);path;⎕TRAP
⍝ Exercise `DeleteValue`
 R←∆Failed
 ⎕TRAP←(999 'C' '. ⍝ Deliberate error')(0 'N')
 path←GetRegPath

⍝ Preconditions
 ##.WinReg.DeleteSubKeyTree path         ⍝ Delete any left-overs
 ##.WinReg.PutString(path,'str1')'hello'
 ##.WinReg.PutString(path,'str2')'universe'
 ##.WinReg.PutValue(path,'val1')42
 →FailsIf 3≠0⊃⍴##.WinReg.GetAllValues path

⍝ Tests...
 →FailsIf 0≠##.WinReg.DeleteValue(path,'str1')
 →FailsIf 0≠##.WinReg.DeleteValue(path,'str2')
 →FailsIf 0≠##.WinReg.DeleteValue(path,'val1')
 →FailsIf 2≠##.WinReg.DeleteValue(path,'doesnot exist')

 →FailsIf 0≠0⊃⍴##.WinReg.GetAllValues path

⍝ Tidy up
 ##.WinReg.DeleteSubKeyTree path

 R←∆OK
